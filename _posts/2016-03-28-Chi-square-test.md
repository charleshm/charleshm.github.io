---
published: true
author: Charles
layout: post
title:  "卡方检验"
date:   2016-03-28 9:30
categories: 机器学习 统计学
---

![此处输入图片的描述][1]

卡方检验(Pearson’s Chi-square test)主要用来做两件事：

- **适合性检验**（Test for Goodness of fit）：检查样本是否符合某种随机分布；
- **独立性检验**（Test for Independence）：检查变量之间是否独立。

----------

#### $\chi^2$ 统计量

我们前面提到过，各种检验方法的差别在于计算的**检验统计量**不同。

我们先来关注下 $\chi^2$ 统计量，

$$\chi^2 = \sum \frac{(A – E)^2}{E} \tag{1}$$

其中 $A$ 表示实际观察次数， $E$ 表示理论观察次数（对比一下 $\chi^2$ 分布）。

> $\chi^2$ 是度量实际观察次数与理论次数偏离程度的一个统计量。

 - $\chi^2$ 越小，表明实际观察次数与理论次数越接近
 - $\chi^2=0$ 表示两者完全吻合
 - $\chi^2$ 越大，表示两者相差越大


----------


#### 举个栗子
我们想判断两组患者的总体阳性率是否相同，

 ![此处输入图片的描述][2]

**步骤1:** 建立检验假设，限定显著性水平.

$$\begin{align*}
H_0:\text{两组患者的总体阳性率相同} \qquad \pi_1=\pi_2\\
H_1:\text{两组患者的总体阳性率不同} \qquad \pi_1\not=\pi_2
\end{align*}$$

这里我们限定显著性水平为 $\alpha = 0.05$.

**步骤2:** 计算检验统计量.

在 $H_0$ 成立的前提条件下，计算 $\chi^2$ 统计量：

$$\begin{align*}
\chi^2 & = \sum \frac{(A – E)^2}{E} \\
& = \frac{(33-16.6)}{16.6}+\frac{(39-55.4)}{55.4}+\frac{(10-26.4)}{26.4}+\frac{(104-87.6)}{87.6}\\
& = 34.32
\end{align*}$$

**步骤3:** 确定P值，做出推断结论.

$$\chi^2_{0.05,1} = 3.84<\chi^2=34.32 \Rightarrow P<0.05$$

按 $\alpha=0.05$ 的水准，拒绝 $H_0$，两组差异有统计
学意义(统计结论)，认为两组总体阳性率不同，可
以认为肺癌患者癌胚抗原的阳性率要高于健康人。



  [1]: http://7xjbdi.com1.z0.glb.clouddn.com/Chi_square_test.png
  [2]: http://7xjbdi.com1.z0.glb.clouddn.com/2016-03-30_202454.png